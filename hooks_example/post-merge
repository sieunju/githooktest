#!/bin/sh
# ë¨¸ì§€ í›„ ë¸Œëœì¹˜ ìë™ ì •ë¦¬

echo "ğŸ”„ Post-merge Start"

# ë¸Œëœì¹˜ ì •ë¦¬ (main, develop, release/* ì œì™¸í•˜ê³  ëª¨ë‘ ì‚­ì œ)
echo "ğŸ§¹ Clear Branch..."
deleted_branch=$(git reflog | grep "checkout: moving from" | head -1 | awk '{print $6}')

# ë³´í˜¸ëœ ë¸Œëœì¹˜ê°€ ì•„ë‹Œ ê²½ìš° ì‚­ì œ
case "$deleted_branch" in
    main|master|develop|release/*)
        echo "ğŸ›¡ï¸  Branch Delete Skip (Protected: $deleted_branch)"
        ;;
    ""|HEAD)
        echo "â„¹ï¸  No branch to delete"
        ;;
    *)
        if git branch -d "$deleted_branch" 2>/dev/null; then
            echo "ğŸ—‘ï¸  Delete Branch '$deleted_branch' Success"
        else
            echo "âš ï¸  Delete Branch '$deleted_branch' Fail (Unmerged or Protected)"
        fi
        ;;
esac

echo "ğŸ‰ Post-merge Completed"